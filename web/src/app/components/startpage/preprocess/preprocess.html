<div class="container">
    <div class="form-section">
        <h3 class="section-title">Choose data to preprocess *</h3>
        <app-upload [acceptedFileTypes]="'.fasta,.fastq,.fa,.fq'" [buttonText]="'Browse...'"
            [placeholderText]="'FASTQ or FASTA file'" [showUploadNote]="true" [uploadNotePath]="'#'" [uploadSpeed]="200"
            (fileSelected)="onFileSelected($event)" (uploadComplete)="onUploadComplete($event)">
        </app-upload>
    </div>

    <div class="form-section">
        <mat-label class="section-label">Constant 5' region: </mat-label>
        <mat-form-field appearance="outline" class="full-width">
            <input matInput [(ngModel)]="constant5Region" />
        </mat-form-field>
    </div>

    <div class="form-section">
        <mat-label class="section-label">Constant 3' region: </mat-label>
        <mat-form-field appearance="outline" class="full-width">
            <input matInput [(ngModel)]="constant3Region" />
        </mat-form-field>
    </div>

    <div class="form-section">
        <label class="section-label">Sequence length range:
            <mat-icon class="info-icon" matTooltip="Define the minimum and maximum length for primer sequences">help_outline</mat-icon>
        </label>
        <div class="slider-group">    
            <div class="slider-header">
                <span class="value-chip range-min">Min 1</span>
                <span class="value-chip">{{ sequenceLengthMin }}</span>
                <span class="value-chip">{{ sequenceLengthMax }}</span>
                <span class="value-chip range-max">Max {{ sequenceLengthRange }}</span>
            </div>
            <div class="dual-range-container">
                <mat-slider [min]="1" [max]="sequenceLengthRange" [step]="1" [displayWith]="formatLabel" discrete
                    class="range-slider min-slider">
                    <input matSliderStartThumb [(ngModel)]="sequenceLengthMin">
                    <input matSliderEndThumb [(ngModel)]="sequenceLengthMax">
                </mat-slider>
            </div>
        </div>
    </div>

    <div class="form-section">
        <label class="section-label">Max allowed error for sequences: 
            <mat-icon class="info-icon" matTooltip="Maximum average base error per sequence (errors derived from Phred scores)">help_outline</mat-icon>
        </label>
        <div class="slider-group">
            <div class="slider-header">
                <span class="value-chip range-min">Min 0.001</span>
                <span class="value-chip">{{ maxAllowedError.toFixed(3) }}</span>
                <span class="value-chip range-max">Max {{ maxErrorRange }}</span>
            </div>
            <div class="dual-range-container">
                <mat-slider [min]="0.001" [max]="maxErrorRange" [step]="0.001" [displayWith]="formatErrorLabel" discrete
                    class="range-slider">
                    <input matSliderThumb [(ngModel)]="maxAllowedError">
                </mat-slider>
            </div>
        </div>
    </div>

   <div class="action-buttons">
      <button 
        mat-raised-button 
        color="primary"
        class="start-button"
        [disabled]="!uploadComplete || isProcessing()"
        (click)="onStart()">
        <mat-icon [class.spinning]="isProcessing()">{{ isProcessing() ? 'sync' : 'play_arrow' }}</mat-icon>
        {{ isProcessing() ? 'Processing...' : 'Start' }}
      </button>

      <button 
        mat-raised-button 
        color="accent"
        class="download-button"
        [class.download-ready]="processedFileName()"
        [disabled]="!processedFileName()"
        (click)="onDownload()">
        <mat-icon>download</mat-icon>
        Download
      </button>
    </div>
</div>
